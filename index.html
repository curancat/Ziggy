<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Miraculos da Cabra</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Lobster&display=swap');
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:#B1B1B1;font-family:'Lobster',cursive;
      display:flex;align-items:center;justify-content:center;height:100vh;position:relative}
    .phone{width:320px;height:600px;background:#F5F5F5;border-radius:30px;
      box-shadow:0 10px 25px rgba(0,0,0,0.3);padding:20px;
      display:flex;flex-direction:column;justify-content:space-between}
    h3 mark{background:#666;color:#fff;padding:5px 10px;border-radius:8px}
    h3{text-align:center;font-size:24px}
    .buttons{display:flex;flex-direction:column;align-items:center;gap:8px}
    button{width:80%;padding:10px;background:#FFC400;border:none;
      border-radius:20px;font-size:18px;cursor:pointer;transition:.3s;
      font-family:'Lobster',cursive}
    button:hover{background:#ff9800;transform:scale(1.03)}
  </style>
</head>
<body>
  <div class="phone">
    <h3><mark>Litlegot</mark></h3>
    <div class="buttons">
      <button onclick="enviarMensagem()">ğŸ’¬ Enviar mensagem</button>
      <button onclick="lerConversa()">ğŸ“– Ler conversa</button>
      <button onclick="concederProtecao()">ğŸ›¡ï¸ GÃªnesis</button>
      <button onclick="verItens()">ğŸ’ InventÃ¡rio</button>
      <button onclick="usarItem()">âœ¨ Usar item</button>
    </div>
  </div>

  <script>
    alert('ZIGGY RECRIAÃ‡ÃƒO');
    const PARTICIPANTES = ['Psique','Abrax','Hell Cat','Beast','Yellowfer','Lindemberg'];
    const ME = 'Litlegot';
    const channel = new BroadcastChannel('global_channel');
    const _load = k => JSON.parse(localStorage.getItem(k)||'[]');
    const _save = (k,v) => localStorage.setItem(k, JSON.stringify(v));

    function addToHistorico(dest, from, msg) {
      const hKey = `hist_${dest}`;
      const historico = _load(hKey);
      historico.push({from, msg});
      _save(hKey, historico);
    }

    channel.onmessage = ev => {
      const {type, data} = ev.data;
      if(type === 'msg' && data.to === ME){
        alert(`ğŸ“¨ De ${data.from}: ${data.text}`);
        addToHistorico(data.from, data.from, data.text);
      }
      if(type === 'usePower' && data.to === ME){
        const itens = _load('items');
        const prot = itens.find(i=>i.target===ME);
        if(prot){
          alert(`ğŸ›¡ï¸ Seu item "${prot.item}" te protegeu de ${data.power}!`);
        } else {
          alert(`ğŸ’” VocÃª foi atingido por "${data.power}" de ${data.from}.`);
        }
      }
    };

    function enviarMensagem(){
      let dest = prompt(`Enviar para?\n${PARTICIPANTES.join(', ')}`);
      if(!PARTICIPANTES.includes(dest)) return alert('InvÃ¡lido.');
      let txt = prompt(`Mensagem de ${ME} p/ ${dest}:`);
      if(!txt) return;
      channel.postMessage({type:'msg', data:{from:ME, to:dest, text:txt.trim()}});
      addToHistorico(dest, ME, txt.trim());
      alert('Enviado!');
    }

    function lerConversa(){
      let com = prompt(`Ver conversa com quem?\n${PARTICIPANTES.join(', ')}`);
      if(!PARTICIPANTES.includes(com)) return alert('InvÃ¡lido.');
      const hKey = `hist_${com}`;
      const historico = _load(hKey);
      if(!historico.length) return alert('Sem mensagens com ' + com);
      alert(historico.map(h => `${h.from}: ${h.msg}`).join('\n'));
    }

    function concederProtecao(){
      let dest = prompt(`Dar item de proteÃ§Ã£o a?\n${PARTICIPANTES.join(', ')}`);
      if(!PARTICIPANTES.includes(dest)) return alert('InvÃ¡lido.');
      let item = prompt('Qual item?');
      if(!item) return;
      const itens = _load('items');
      itens.push({from:ME, target:dest, item:item.trim()});
      _save('items', itens);
      alert(`ğŸ›¡ï¸ Item "${item.trim()}" concedido a ${dest}`);
    }

    function verItens(){
      const itens = _load('items').filter(i=>i.target===ME);
      if(!itens.length) return alert('Sem itens.');
      alert(itens.map((i,n)=>`${n+1}. ${i.item} (de ${i.from})`).join('\n'));
    }

    function usarItem(){
      const itens = _load('items').filter(i=>i.target===ME);
      if(!itens.length) return alert('Sem itens.');
      let idx = +prompt(itens.map((i,n)=>`${n+1}. ${i.item}`).join('\n')+'\nEscolha nÂº:')-1;
      const sel = itens[idx];
      if(!sel) return alert('InvÃ¡lido.');
      alert(`âœ¨ VocÃª usou "${sel.item}"!`);
      const all = _load('items');
      all.splice(all.findIndex(x=>x===sel),1);
      _save('items',all);
    }
  </script>
</body>
</html>
